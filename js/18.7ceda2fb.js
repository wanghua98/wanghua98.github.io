"use strict";(self["webpackChunkvue_demo2"]=self["webpackChunkvue_demo2"]||[]).push([[18],{8018:function(e,l,r){r.r(l),r.d(l,{default:function(){return E}});var s=r(6768),t=r(4232),a=r(5130),o=r(144),n=r(9871);const c={class:"elder-serve"},i={class:"elder-serve-section"},u={key:0},d={class:"elder-serve-list"},v=["onClick"],k={key:1},p={key:0,class:"elder-serve-dialog-overlay"},L={class:"elder-serve-dialog"},y={class:"elder-serve-section"},m={key:0},g={class:"elder-serve-list"},h=["onClick"],b={key:1};var f={__name:"AEldserve",setup(e){const l=(0,o.KR)([]),r=(0,o.KR)([]),f=(0,o.KR)(!1),_=(0,o.KR)(null),C=(0,o.KR)({chaperonId:"",serviceDate:"",descriptionOfSymptoms:"",medicalHistory:"",allergyHistory:""}),E=(0,o.KR)(""),I=(0,o.KR)(""),D=(e,l)=>{E.value=e,I.value=l,setTimeout((()=>{E.value="",I.value=""}),3e3)},S=n.A.API_BASE_URL,w=async()=>{try{const e=new Date,r=e.getFullYear(),s=String(e.getMonth()+1).padStart(2,"0"),t=String(e.getDate()).padStart(2,"0"),a=`${r}-${s}-${t}`,o=await fetch(`${S}/services?date=${a}`,{method:"GET"}),n=await o.json();1===n.code?(l.value=n.data.rows,D("可预约陪诊员列表获取成功！","success")):D(`获取可预约陪诊员列表失败: ${n.msg}`,"error")}catch(e){console.error("获取可预约陪诊员列表出错:",e),D("获取可预约陪诊员列表网络请求失败，请检查网络！","error")}},$=e=>{_.value=e,C.value.chaperonId=e.id;const l=new Date;C.value.serviceDate=l.toISOString().split("T")[0],f.value=!0},H=()=>{f.value=!1,_.value=null,W()},W=()=>{C.value={chaperonId:"",serviceDate:"",descriptionOfSymptoms:"",medicalHistory:"",allergyHistory:""}},X=async()=>{if(C.value.chaperonId&&C.value.serviceDate)try{const e=localStorage.getItem("token"),l=await fetch(`${S}/services/book`,{method:"POST",headers:{"Content-Type":"application/json",token:e},body:JSON.stringify(C.value)}),r=await l.json();1===r.code?(D("预约成功！","success"),H(),A()):D(`预约失败: ${r.msg}`,"error")}catch(e){console.error("预约陪诊服务出错:",e),D("预约陪诊服务网络请求失败，请检查网络！","error")}else D("请选择陪诊员并填写服务日期！","error")},A=async()=>{try{const e=await fetch(`${S}/services/book`,{method:"GET"}),l=await e.json();1===l.code?(r.value=l.data.rows,D("我的陪诊列表获取成功！","success")):D(`获取我的陪诊列表失败: ${l.msg}`,"error")}catch(e){console.error("获取我的陪诊列表出错:",e),D("获取我的陪诊列表网络请求失败，请检查网络！","error")}},K=async e=>{if(confirm(`确定要取消订单ID为 ${e} 的预约吗？`))try{const l=await fetch(`${S}/services/book?chaperonId=${e}`,{method:"DELETE"}),r=await l.json();1===r.code?(D("取消预约成功！","success"),A()):D(`取消预约失败: ${r.msg}`,"error")}catch(l){console.error("取消陪诊服务出错:",l),D("取消陪诊服务网络请求失败，请检查网络！","error")}};return(0,s.sV)((()=>{w(),A()})),(e,o)=>((0,s.uX)(),(0,s.CE)("div",c,[o[22]||(o[22]=(0,s.Lk)("h1",{class:"elder-serve-title"},"老人陪诊服务",-1)),(0,s.Lk)("section",i,[o[9]||(o[9]=(0,s.Lk)("h2",{class:"elder-serve-section-title"},"1. 可预约陪诊员列表",-1)),(0,s.Lk)("button",{onClick:w,class:"elder-serve-button"}," 刷新可预约列表 "),l.value.length>0?((0,s.uX)(),(0,s.CE)("div",u,[(0,s.Lk)("ul",d,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(l.value,(e=>((0,s.uX)(),(0,s.CE)("li",{key:e.id,class:"elder-serve-list-item"},[(0,s.Lk)("p",null,[o[4]||(o[4]=(0,s.Lk)("strong",null,"ID:",-1)),(0,s.eW)(" "+(0,t.v_)(e.id),1)]),(0,s.Lk)("p",null,[o[5]||(o[5]=(0,s.Lk)("strong",null,"姓名:",-1)),(0,s.eW)(" "+(0,t.v_)(e.name),1)]),(0,s.Lk)("p",null,[o[6]||(o[6]=(0,s.Lk)("strong",null,"性别:",-1)),(0,s.eW)(" "+(0,t.v_)("1"===e.gender?"男":"女"),1)]),(0,s.Lk)("p",null,[o[7]||(o[7]=(0,s.Lk)("strong",null,"电话:",-1)),(0,s.eW)(" "+(0,t.v_)(e.phone),1)]),(0,s.Lk)("p",null,[o[8]||(o[8]=(0,s.Lk)("strong",null,"介绍:",-1)),(0,s.eW)(" "+(0,t.v_)(e.introduction),1)]),(0,s.Lk)("button",{onClick:l=>$(e),class:"elder-serve-button primary"}," 预约TA ",8,v)])))),128))])])):((0,s.uX)(),(0,s.CE)("p",k,"暂无可用陪诊员。"))]),f.value?((0,s.uX)(),(0,s.CE)("div",p,[(0,s.Lk)("div",L,[o[10]||(o[10]=(0,s.Lk)("h3",{class:"elder-serve-dialog-title"},"预约陪诊服务",-1)),(0,s.Lk)("p",null," 您正在预约："+(0,t.v_)(_.value.name)+" (ID: "+(0,t.v_)(_.value.id)+") ",1),o[11]||(o[11]=(0,s.Lk)("label",{for:"serviceDate"},"服务日期 (YYYY-MM-DD):",-1)),(0,s.bo)((0,s.Lk)("input",{type:"date",id:"serviceDate","onUpdate:modelValue":o[0]||(o[0]=e=>C.value.serviceDate=e),required:"",class:"elder-serve-input"},null,512),[[a.Jo,C.value.serviceDate]]),o[12]||(o[12]=(0,s.Lk)("label",{for:"descriptionOfSymptoms"},"症状描述:",-1)),(0,s.bo)((0,s.Lk)("textarea",{id:"descriptionOfSymptoms","onUpdate:modelValue":o[1]||(o[1]=e=>C.value.descriptionOfSymptoms=e),class:"elder-serve-textarea"},null,512),[[a.Jo,C.value.descriptionOfSymptoms]]),o[13]||(o[13]=(0,s.Lk)("label",{for:"medicalHistory"},"病史:",-1)),(0,s.bo)((0,s.Lk)("textarea",{id:"medicalHistory","onUpdate:modelValue":o[2]||(o[2]=e=>C.value.medicalHistory=e),class:"elder-serve-textarea"},null,512),[[a.Jo,C.value.medicalHistory]]),o[14]||(o[14]=(0,s.Lk)("label",{for:"allergyHistory"},"过敏史:",-1)),(0,s.bo)((0,s.Lk)("textarea",{id:"allergyHistory","onUpdate:modelValue":o[3]||(o[3]=e=>C.value.allergyHistory=e),class:"elder-serve-textarea"},null,512),[[a.Jo,C.value.allergyHistory]]),(0,s.Lk)("div",{class:"elder-serve-dialog-actions"},[(0,s.Lk)("button",{onClick:X,class:"elder-serve-button primary"}," 确认预约 "),(0,s.Lk)("button",{onClick:H,class:"elder-serve-button"}," 取消 ")])])])):(0,s.Q3)("",!0),(0,s.Lk)("section",y,[o[21]||(o[21]=(0,s.Lk)("h2",{class:"elder-serve-section-title"},"2. 我的陪诊列表",-1)),(0,s.Lk)("button",{onClick:A,class:"elder-serve-button"}," 刷新我的陪诊 "),r.value.length>0?((0,s.uX)(),(0,s.CE)("div",m,[(0,s.Lk)("ul",g,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(r.value,(e=>((0,s.uX)(),(0,s.CE)("li",{key:e.orderId,class:"elder-serve-list-item"},[(0,s.Lk)("p",null,[o[15]||(o[15]=(0,s.Lk)("strong",null,"订单ID:",-1)),(0,s.eW)(" "+(0,t.v_)(e.orderId),1)]),(0,s.Lk)("p",null,[o[16]||(o[16]=(0,s.Lk)("strong",null,"预约时间:",-1)),(0,s.eW)(" "+(0,t.v_)(e.booktime),1)]),(0,s.Lk)("p",null,[o[17]||(o[17]=(0,s.Lk)("strong",null,"陪诊员姓名:",-1)),(0,s.eW)(" "+(0,t.v_)(e.name),1)]),(0,s.Lk)("p",null,[o[18]||(o[18]=(0,s.Lk)("strong",null,"陪诊员性别:",-1)),(0,s.eW)(" "+(0,t.v_)("1"===e.gender?"男":"女"),1)]),(0,s.Lk)("p",null,[o[19]||(o[19]=(0,s.Lk)("strong",null,"陪诊员电话:",-1)),(0,s.eW)(" "+(0,t.v_)(e.phone),1)]),(0,s.Lk)("p",null,[o[20]||(o[20]=(0,s.Lk)("strong",null,"陪诊员介绍:",-1)),(0,s.eW)(" "+(0,t.v_)(e.introduction),1)]),(0,s.Lk)("button",{onClick:l=>K(e.orderId),class:"elder-serve-button"}," 取消预约 ",8,h)])))),128))])])):((0,s.uX)(),(0,s.CE)("p",b,"您还没有陪诊预约。"))]),E.value?((0,s.uX)(),(0,s.CE)("div",{key:1,class:(0,t.C4)(["elder-serve-message",I.value])},(0,t.v_)(E.value),3)):(0,s.Q3)("",!0)]))}},_=r(1241);const C=(0,_.A)(f,[["__scopeId","data-v-924b064e"]]);var E=C},9871:function(e,l){const r={API_BASE_URL:"http://14.103.237.241:8080"};l.A=r}}]);
//# sourceMappingURL=18.7ceda2fb.js.map