{"version":3,"file":"js/83.27a1d2df.js","mappings":"qQAuCMA,EAAgB,YAChBC,EAAkB,gB,0CAVxB,MAAMC,GAAqBC,EAAAA,EAAAA,IAAI,CAC7BC,WAAY,KACZC,YAAa,KAETC,GAAmBH,EAAAA,EAAAA,IAAI,IAIvBI,EAAWC,EAAAA,EAAOC,aAKlBC,EAAiBC,UACrB,IAAKC,EAASC,GAAI,CAChB,MAAMC,QAAkBF,EAASG,OACjC,MAAM,IAAIC,MAAMF,EAAUG,KAAO,OACnC,CACA,OAAOL,EAASG,MAAM,EAIlBG,EAAiBP,UACrB,IACE,MAAMC,QAAiBO,MAAM,GAAGZ,IAAWP,IAAiB,CAC1DoB,OAAQ,OACRC,QAAS,CACP,eAAgB,oBAElBC,KAAMC,KAAKC,UAAUtB,EAAmBuB,SAEpCC,QAAahB,EAAeE,GAChB,IAAdc,EAAKC,MACPC,MAAM,aACN1B,EAAmBuB,MAAQ,CAAErB,WAAY,KAAMC,YAAa,IAC5DwB,KAEAD,MAAM,SAASF,EAAKT,MAExB,CAAE,MAAOa,GACPC,QAAQD,MAAM,YAAaA,GAC3BF,MAAM,aAAaE,EAAME,UAC3B,GAIIH,EAAwBlB,UAC5B,IACE,MAAMC,QAAiBO,MAAM,GAAGZ,IAAWN,IAAqB,CAC9DmB,OAAQ,QAEJM,QAAahB,EAAeE,GAChB,IAAdc,EAAKC,KACPrB,EAAiBmB,MAAQC,EAAKA,KAAKO,MAEnCL,MAAM,gBAAgBF,EAAKT,OAC3BX,EAAiBmB,MAAQ,GAE7B,CAAE,MAAOK,GACPC,QAAQD,MAAM,eAAgBA,GAC9BF,MAAM,gBAAgBE,EAAME,WAC5B1B,EAAiBmB,MAAQ,EAC3B,GAIIS,EAAmBvB,UACvB,GAAKwB,QAAQ,YAAYC,aAGzB,IACE,MAAMxB,QAAiBO,MAAM,GAAGZ,IAAWP,QAAoBoC,IAAa,CAC1EhB,OAAQ,WAEJM,QAAahB,EAAeE,GAChB,IAAdc,EAAKC,MACPC,MAAM,aACNC,KAEAD,MAAM,SAASF,EAAKT,MAExB,CAAE,MAAOa,GACPC,QAAQD,MAAM,YAAaA,GAC3BF,MAAM,aAAaE,EAAME,UAC3B,G,OAIFK,EAAAA,EAAAA,KAAU,KACRR,GAAuB,I,+mCCjHzB,MAAMS,GAA2B,OAAgB,EAAQ,CAAC,CAAC,YAAY,qBAEvE,O,qBCPA,MAAM9B,EAAS,CAEbC,aAAc,8BAGhB,K","sources":["webpack://vue-demo2/./src/views/Manager/AservePublishing.vue","webpack://vue-demo2/./src/views/Manager/AservePublishing.vue?2f26","webpack://vue-demo2/./src/utils/config.js"],"sourcesContent":["<template>\r\n  <section class=\"service-publishing\">\r\n    <h2>陪诊服务发布与管理</h2>\r\n\r\n    <h3>发布陪诊服务</h3>\r\n    <form @submit.prevent=\"publishService\">\r\n      <label for=\"publish-chaperone-id\">陪诊人员ID:</label>\r\n      <input type=\"number\" id=\"publish-chaperone-id\" v-model=\"publishServiceData.chaperonId\" required>\r\n      <label for=\"publish-date\">服务日期:</label>\r\n      <input type=\"date\" id=\"publish-date\" v-model=\"publishServiceData.serviceDate\" required>\r\n      <button type=\"submit\">发布服务</button>\r\n    </form>\r\n\r\n    <h3>已发布陪诊服务列表</h3>\r\n    <button @click=\"fetchAdminServiceList\">刷新已发布列表</button>\r\n    <ul>\r\n      <li v-for=\"service in adminServiceList\" :key=\"service.id\">\r\n        ID: {{ service.id }}, 陪诊人员姓名: {{ service.name }}, 手机: {{ service.phone }}, 服务日期: {{ service.date }}\r\n        <button @click=\"unpublishService(service.id)\">下架</button>\r\n      </li>\r\n    </ul>\r\n  </section>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, onMounted } from 'vue';\r\nimport config from '@/utils/config';\r\n\r\n\r\n// 陪诊服务发布与管理\r\nconst publishServiceData = ref({\r\n  chaperonId: null,\r\n  serviceDate: ''\r\n});\r\nconst adminServiceList = ref([]);\r\n\r\n// Backend API paths\r\n// 使用全局配置的API地址\r\nconst BASE_URL = config.API_BASE_URL;\r\nconst SERVICES_PATH = '/services';\r\nconst SERVICES_PATH_ALL='/services/all';\r\n\r\n// Helper function: Handle Fetch response\r\nconst handleResponse = async (response) => {\r\n  if (!response.ok) {\r\n    const errorData = await response.json();\r\n    throw new Error(errorData.msg || '请求失败');\r\n  }\r\n  return response.json();\r\n};\r\n\r\n// 5.6 Publish Chaperone Service\r\nconst publishService = async () => {\r\n  try {\r\n    const response = await fetch(`${BASE_URL}${SERVICES_PATH}`, {\r\n      method: 'POST',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n      },\r\n      body: JSON.stringify(publishServiceData.value)\r\n    });\r\n    const data = await handleResponse(response);\r\n    if (data.code === 1) {\r\n      alert('发布陪诊服务成功！');\r\n      publishServiceData.value = { chaperonId: null, serviceDate: '' };\r\n      fetchAdminServiceList(); // Refresh published list\r\n    } else {\r\n      alert(`发布失败: ${data.msg}`);\r\n    }\r\n  } catch (error) {\r\n    console.error('发布陪诊服务出错:', error);\r\n    alert(`发布陪诊服务失败: ${error.message}`);\r\n  }\r\n};\r\n\r\n// 5.7 Administrator Get Chaperone Service List\r\nconst fetchAdminServiceList = async () => {\r\n  try {\r\n    const response = await fetch(`${BASE_URL}${SERVICES_PATH_ALL}`, {\r\n      method: 'GET',\r\n    });\r\n    const data = await handleResponse(response);\r\n    if (data.code === 1) {\r\n      adminServiceList.value = data.data.rows;\r\n    } else {\r\n      alert(`获取已发布陪诊列表失败: ${data.msg}`);\r\n      adminServiceList.value = [];\r\n    }\r\n  } catch (error) {\r\n    console.error('获取已发布陪诊列表出错:', error);\r\n    alert(`获取已发布陪诊列表失败: ${error.message}`);\r\n    adminServiceList.value = [];\r\n  }\r\n};\r\n\r\n// 5.8 Unpublish Chaperone Service\r\nconst unpublishService = async (serviceId) => {\r\n  if (!confirm(`确定要下架ID为 ${serviceId} 的陪诊服务吗？`)) {\r\n    return;\r\n  }\r\n  try {\r\n    const response = await fetch(`${BASE_URL}${SERVICES_PATH}?id=${serviceId}`, {\r\n      method: 'DELETE',\r\n    });\r\n    const data = await handleResponse(response);\r\n    if (data.code === 1) {\r\n      alert('下架陪诊服务成功！');\r\n      fetchAdminServiceList(); // Refresh published list\r\n    } else {\r\n      alert(`下架失败: ${data.msg}`);\r\n    }\r\n  } catch (error) {\r\n    console.error('下架陪诊服务出错:', error);\r\n    alert(`下架陪诊服务失败: ${error.message}`);\r\n  }\r\n};\r\n\r\n// Automatically fetch published service list on component mount\r\nonMounted(() => {\r\n  fetchAdminServiceList();\r\n});\r\n</script>\r\n\r\n<style scoped>\r\n.service-publishing {\r\n  background-color: #f9f9f9;\r\n  border: 1px solid #ddd;\r\n  border-radius: 8px;\r\n  padding: 20px;\r\n  margin-bottom: 30px;\r\n}\r\n\r\nh2, h3 {\r\n  color: #333;\r\n}\r\n\r\nform {\r\n  display: grid;\r\n  grid-template-columns: 120px 1fr;\r\n  gap: 10px;\r\n  margin-bottom: 20px;\r\n}\r\n\r\nlabel {\r\n  text-align: right;\r\n  padding-right: 10px;\r\n  line-height: 32px;\r\n}\r\n\r\ninput[type=\"text\"],\r\ninput[type=\"number\"],\r\ninput[type=\"date\"],\r\ntextarea,\r\nselect {\r\n  width: calc(100% - 20px);\r\n  padding: 8px 10px;\r\n  border: 1px solid #ccc;\r\n  border-radius: 4px;\r\n}\r\n\r\nbutton {\r\n  grid-column: 2 / 3;\r\n  width: auto;\r\n  padding: 10px 15px;\r\n  background-color: #007bff;\r\n  color: white;\r\n  border: none;\r\n  border-radius: 5px;\r\n  cursor: pointer;\r\n  font-size: 16px;\r\n  margin-top: 10px;\r\n}\r\n\r\nbutton:hover {\r\n  background-color: #0056b3;\r\n}\r\n\r\nul {\r\n  list-style-type: none;\r\n  padding: 0;\r\n}\r\n\r\nli {\r\n  background-color: #fff;\r\n  border: 1px solid #eee;\r\n  padding: 10px;\r\n  margin-bottom: 8px;\r\n  border-radius: 5px;\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n}\r\n\r\nli button {\r\n  margin-left: 15px;\r\n  padding: 5px 10px;\r\n  font-size: 14px;\r\n}\r\n\r\n.service-publishing ul li button {\r\n  background-color: #dc3545;\r\n}\r\n.service-publishing ul li button:hover {\r\n  background-color: #c82333;\r\n}\r\n</style>","import script from \"./AservePublishing.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./AservePublishing.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./AservePublishing.vue?vue&type=style&index=0&id=dc3add2a&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-dc3add2a\"]])\n\nexport default __exports__","// 全局配置文件\nconst config = {\n  // 后端API基础地址\n  API_BASE_URL: 'http://14.103.237.241:8080'\n};\n\nexport default config;"],"names":["SERVICES_PATH","SERVICES_PATH_ALL","publishServiceData","ref","chaperonId","serviceDate","adminServiceList","BASE_URL","config","API_BASE_URL","handleResponse","async","response","ok","errorData","json","Error","msg","publishService","fetch","method","headers","body","JSON","stringify","value","data","code","alert","fetchAdminServiceList","error","console","message","rows","unpublishService","confirm","serviceId","onMounted","__exports__"],"sourceRoot":""}