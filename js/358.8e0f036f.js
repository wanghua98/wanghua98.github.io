"use strict";(self["webpackChunkvue_demo2"]=self["webpackChunkvue_demo2"]||[]).push([[358],{2358:function(e,r,s){s.r(r),s.d(r,{default:function(){return $}});var t=s(6768),o=s(5130),a=s(4232);const l={class:"admin-container"},i={class:"card"},d={class:"form-group full-width"},u={class:"form-group"},n={class:"form-group"},c={class:"form-group"},h={class:"form-group"},y={class:"form-group full-width"},g={class:"form-group full-width"},p={class:"card"},m={class:"query-controls"},k={class:"form-group"},b=["disabled"],v={key:0,class:"spinner"},L={key:1,class:"results-grid"},f={class:"result-card text-card"},w={class:"result-card text-card"},q={class:"result-card list-card"},M={key:0},R={key:1,class:"no-data"},D={class:"result-card list-card"},H={key:0},C={key:1,class:"no-data"},F={class:"result-card list-card"},E={key:0},I={key:1,class:"no-data"},S={class:"result-card list-card"},U={key:0},A={key:1,class:"no-data"};function T(e,r,s,T,X,x){return(0,t.uX)(),(0,t.CE)("div",l,[r[27]||(r[27]=(0,t.Fv)('<header class="admin-header"><svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="header-icon"><path d="M12 2a10 10 0 1 0 10 10A10 10 0 0 0 12 2z"></path><path d="M12 18a6 6 0 1 0 0-12 6 6 0 0 0 0 12z"></path><path d="M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"></path></svg><h1>管理员健康管理中心</h1><p>在此页面统一录入和查询用户的健康数据</p></header>',1)),(0,t.Lk)("div",i,[r[18]||(r[18]=(0,t.Lk)("h2",{class:"card-title"},[(0,t.Lk)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[(0,t.Lk)("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),(0,t.Lk)("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]),(0,t.eW)(" 录入健康数据 ")],-1)),(0,t.Lk)("form",{onSubmit:r[7]||(r[7]=(0,o.D$)(((...e)=>x.submitHealthData&&x.submitHealthData(...e)),["prevent"])),class:"form-grid"},[(0,t.Lk)("div",d,[r[10]||(r[10]=(0,t.Lk)("label",{for:"recordUserId"},"用户ID (必填)",-1)),(0,t.bo)((0,t.Lk)("input",{type:"number",id:"recordUserId","onUpdate:modelValue":r[0]||(r[0]=e=>X.recordFormData.id=e),required:"",min:"1",placeholder:"请输入要录入数据的用户ID"},null,512),[[o.Jo,X.recordFormData.id,void 0,{number:!0}]])]),(0,t.Lk)("div",u,[r[11]||(r[11]=(0,t.Lk)("label",{for:"heartRate"},"心率 (次/分)",-1)),(0,t.bo)((0,t.Lk)("input",{type:"number",id:"heartRate","onUpdate:modelValue":r[1]||(r[1]=e=>X.recordFormData.heartRate=e),placeholder:"例如: 75"},null,512),[[o.Jo,X.recordFormData.heartRate,void 0,{number:!0}]])]),(0,t.Lk)("div",n,[r[12]||(r[12]=(0,t.Lk)("label",{for:"bloodPressure"},"血压 (收缩压/舒张压)",-1)),(0,t.bo)((0,t.Lk)("input",{type:"text",id:"bloodPressure","onUpdate:modelValue":r[2]||(r[2]=e=>X.recordFormData.bloodPressure=e),placeholder:"例如: 120/80"},null,512),[[o.Jo,X.recordFormData.bloodPressure]])]),(0,t.Lk)("div",c,[r[13]||(r[13]=(0,t.Lk)("label",{for:"bloodSugar"},"血糖 (mmol/L)",-1)),(0,t.bo)((0,t.Lk)("input",{type:"number",step:"0.1",id:"bloodSugar","onUpdate:modelValue":r[3]||(r[3]=e=>X.recordFormData.bloodSugar=e),placeholder:"例如: 5.8"},null,512),[[o.Jo,X.recordFormData.bloodSugar,void 0,{number:!0}]])]),(0,t.Lk)("div",h,[r[14]||(r[14]=(0,t.Lk)("label",{for:"weight"},"体重 (kg)",-1)),(0,t.bo)((0,t.Lk)("input",{type:"number",step:"0.1",id:"weight","onUpdate:modelValue":r[4]||(r[4]=e=>X.recordFormData.weight=e),placeholder:"例如: 65.5"},null,512),[[o.Jo,X.recordFormData.weight,void 0,{number:!0}]])]),(0,t.Lk)("div",y,[r[15]||(r[15]=(0,t.Lk)("label",{for:"medicalHistory"},"病史",-1)),(0,t.bo)((0,t.Lk)("input",{type:"text",id:"medicalHistory","onUpdate:modelValue":r[5]||(r[5]=e=>X.recordFormData.medicalHistory=e),placeholder:"输入用户的既往病史，如高血压、糖尿病等"},null,512),[[o.Jo,X.recordFormData.medicalHistory]])]),(0,t.Lk)("div",g,[r[16]||(r[16]=(0,t.Lk)("label",{for:"allergyHistory"},"过敏史",-1)),(0,t.bo)((0,t.Lk)("input",{type:"text",id:"allergyHistory","onUpdate:modelValue":r[6]||(r[6]=e=>X.recordFormData.allergyHistory=e),placeholder:"输入用户的过敏史，如青霉素过敏、花粉过敏等"},null,512),[[o.Jo,X.recordFormData.allergyHistory]])]),r[17]||(r[17]=(0,t.Lk)("div",{class:"form-group full-width"},[(0,t.Lk)("button",{type:"submit",class:"btn btn-primary"},"提交数据")],-1))],32),X.recordMessage?((0,t.uX)(),(0,t.CE)("div",{key:0,class:(0,a.C4)(["message",X.recordMessageType])},(0,a.v_)(X.recordMessage),3)):(0,t.Q3)("",!0)]),(0,t.Lk)("div",p,[r[26]||(r[26]=(0,t.Fv)('<h2 class="card-title"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg> 查询健康历史数据 </h2>',1)),(0,t.Lk)("div",m,[(0,t.Lk)("div",k,[r[19]||(r[19]=(0,t.Lk)("label",{for:"queryUserId"},"用户ID (必填)",-1)),(0,t.bo)((0,t.Lk)("input",{type:"number",id:"queryUserId","onUpdate:modelValue":r[8]||(r[8]=e=>X.queryUserId=e),required:"",min:"1",placeholder:"请输入要查询的用户ID"},null,512),[[o.Jo,X.queryUserId,void 0,{number:!0}]])]),(0,t.Lk)("button",{onClick:r[9]||(r[9]=(...e)=>x.fetchHealthHistory&&x.fetchHealthHistory(...e)),class:"btn btn-secondary",disabled:X.loading},[X.loading?((0,t.uX)(),(0,t.CE)("span",v)):(0,t.Q3)("",!0),(0,t.eW)(" "+(0,a.v_)(X.loading?"查询中...":"查询历史"),1)],8,b)]),X.queryMessage&&!X.loading?((0,t.uX)(),(0,t.CE)("div",{key:0,class:(0,a.C4)(["message",X.queryMessageType])},(0,a.v_)(X.queryMessage),3)):(0,t.Q3)("",!0),X.searchAttempted&&!X.loading&&"success"===X.queryMessageType?((0,t.uX)(),(0,t.CE)("div",L,[(0,t.Lk)("div",f,[r[20]||(r[20]=(0,t.Lk)("h3",null,"病史",-1)),(0,t.Lk)("p",null,(0,a.v_)(X.queryResults.medicalHistory||"无记录"),1)]),(0,t.Lk)("div",w,[r[21]||(r[21]=(0,t.Lk)("h3",null,"过敏史",-1)),(0,t.Lk)("p",null,(0,a.v_)(X.queryResults.allergyHistory||"无记录"),1)]),(0,t.Lk)("div",q,[r[22]||(r[22]=(0,t.Lk)("h3",null,"心率历史 (次/分)",-1)),X.queryResults.heartRate&&X.queryResults.heartRate.length?((0,t.uX)(),(0,t.CE)("ul",M,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(X.queryResults.heartRate,((e,r)=>((0,t.uX)(),(0,t.CE)("li",{key:r},(0,a.v_)(e),1)))),128))])):((0,t.uX)(),(0,t.CE)("p",R,"无数据"))]),(0,t.Lk)("div",D,[r[23]||(r[23]=(0,t.Lk)("h3",null,"血压历史 (收缩/舒张)",-1)),X.queryResults.bloodPressure&&X.queryResults.bloodPressure.length?((0,t.uX)(),(0,t.CE)("ul",H,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(X.queryResults.bloodPressure,((e,r)=>((0,t.uX)(),(0,t.CE)("li",{key:r},(0,a.v_)(e.systolic)+"/"+(0,a.v_)(e.diastolic),1)))),128))])):((0,t.uX)(),(0,t.CE)("p",C,"无数据"))]),(0,t.Lk)("div",F,[r[24]||(r[24]=(0,t.Lk)("h3",null,"血糖历史 (mmol/L)",-1)),X.queryResults.bloodSugar&&X.queryResults.bloodSugar.length?((0,t.uX)(),(0,t.CE)("ul",E,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(X.queryResults.bloodSugar,((e,r)=>((0,t.uX)(),(0,t.CE)("li",{key:r},(0,a.v_)(e),1)))),128))])):((0,t.uX)(),(0,t.CE)("p",I,"无数据"))]),(0,t.Lk)("div",S,[r[25]||(r[25]=(0,t.Lk)("h3",null,"体重历史 (kg)",-1)),X.queryResults.weight&&X.queryResults.weight.length?((0,t.uX)(),(0,t.CE)("ul",U,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(X.queryResults.weight,((e,r)=>((0,t.uX)(),(0,t.CE)("li",{key:r},(0,a.v_)(e),1)))),128))])):((0,t.uX)(),(0,t.CE)("p",A,"无数据"))])])):(0,t.Q3)("",!0)])])}s(8111),s(2489),s(116),s(1701);var X=s(9871),x={name:"HealthManagementAdmin",data(){return{BASE_URL:X.A.API_BASE_URL,recordFormData:{id:null,medicalHistory:"",allergyHistory:"",heartRate:null,bloodPressure:"",bloodSugar:null,weight:null},recordMessage:"",recordMessageType:"",queryUserId:null,loading:!1,queryMessage:"",queryMessageType:"",searchAttempted:!1,queryResults:{heartRate:[],bloodPressure:[],bloodSugar:[],weight:[],medicalHistory:"",allergyHistory:""}}},methods:{getAuthToken(){return localStorage.getItem("adminToken")},async submitHealthData(){if(this.recordMessage="",!this.recordFormData.id)return this.recordMessage="用户ID是必填项！",void(this.recordMessageType="error");const e=this.getAuthToken();if(!e)return this.recordMessage="认证失败，请以管理员身份登录。",void(this.recordMessageType="error");const r={};for(const t in this.recordFormData)null===this.recordFormData[t]||""===this.recordFormData[t]||Number.isNaN(this.recordFormData[t])||(r[t]=this.recordFormData[t]);try{const s=await fetch(`${this.BASE_URL}/health/record`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify(r)}),t=await s.json();s.ok?(this.recordMessage="健康数据录入成功！",this.recordMessageType="success",this.recordFormData={id:this.recordFormData.id,medicalHistory:"",allergyHistory:"",heartRate:null,bloodPressure:"",bloodSugar:null,weight:null}):(this.recordMessage=`录入失败: ${t.msg||s.statusText}`,this.recordMessageType="error")}catch(s){this.recordMessage="网络请求失败，请检查后端服务是否正常。",this.recordMessageType="error"}},async fetchHealthHistory(){if(this.searchAttempted=!0,this.queryMessage="",this.queryResults={heartRate:[],bloodPressure:[],bloodSugar:[],weight:[],medicalHistory:"",allergyHistory:""},!this.queryUserId)return this.queryMessage="请输入要查询的用户ID！",void(this.queryMessageType="error");const e=this.getAuthToken();if(!e)return this.queryMessage="认证失败，请以管理员身份登录。",void(this.queryMessageType="error");this.loading=!0;const r=["heartRate","bloodPressure","bloodSugar","weight","medicalHistory","allergyHistory"];try{const s=r.map((r=>{const s=`${this.BASE_URL}/health/${r}/history?id=${this.queryUserId}`;return fetch(s,{headers:{Authorization:`Bearer ${e}`}}).then((async e=>{if(!e.ok){const s=await e.json().catch((()=>({msg:e.statusText})));throw new Error(`用户(ID: ${this.queryUserId})的'${r}'数据查询失败: ${s.msg}`)}const s=e.headers.get("content-type");return s&&s.includes("application/json")?e.json():e.text()}))})),t=await Promise.allSettled(s),o=t.filter((e=>"fulfilled"===e.status));if(0===o.length){const e=t.find((e=>"rejected"===e.status));throw new Error(e.reason.message||"所有数据请求均失败")}const[a,l,i,d,u,n]=t.map((e=>"fulfilled"===e.status?e.value:Array.isArray(this.queryResults[r[t.indexOf(e)]])?[]:""));this.queryResults={heartRate:a,bloodPressure:l,bloodSugar:i,weight:d,medicalHistory:u,allergyHistory:n},this.queryMessage="查询成功！",this.queryMessageType="success"}catch(s){this.queryMessage=`查询失败: ${s.message}`,this.queryMessageType="error",console.error("查询健康历史数据出错:",s)}finally{this.loading=!1}}}},_=s(1241);const P=(0,_.A)(x,[["render",T]]);var $=P},9871:function(e,r){const s={API_BASE_URL:"https://14.103.237.241"};r.A=s}}]);
//# sourceMappingURL=358.8e0f036f.js.map