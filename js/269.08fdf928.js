"use strict";(self["webpackChunkvue_demo2"]=self["webpackChunkvue_demo2"]||[]).push([[269],{8269:function(e,t,a){a.r(t),a.d(t,{default:function(){return x}});var l=a(6768),r=a(5130),o=a(4232);const i={class:"health-management-container"},s={key:0,class:"binding-container"},n={class:"binding-card"},d={class:"form-group"},h={class:"form-group"},c={class:"form-group"},u={key:1,class:"data-view-container"},m={class:"info-card"},g={class:"info-header"},k={class:"info-body"},L={class:"info-item"},v={class:"info-item"},b={class:"info-item"},f={class:"metrics-grid"},y={class:"metric-card"},p={class:"metric-value"},D={class:"metric-history"},_={class:"metric-card"},I={class:"metric-value"},w={class:"metric-history"},A={class:"metric-history"},S={class:"metric-card"},E={class:"metric-value"},H={class:"metric-history"},$={class:"metric-card"},B={class:"metric-value"},C={class:"metric-history"},P={class:"history-section"},R={class:"history-card"},j={class:"history-card"};function F(e,t,a,F,U,N){return(0,l.uX)(),(0,l.CE)("div",i,[U.elderInfo?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.CE)("div",s,[(0,l.Lk)("div",n,[t[8]||(t[8]=(0,l.Lk)("h2",null,"绑定您的亲属",-1)),t[9]||(t[9]=(0,l.Lk)("p",{class:"subtitle"},"绑定后即可查看老人的健康数据",-1)),(0,l.Lk)("form",{onSubmit:t[3]||(t[3]=(0,r.D$)(((...e)=>N.bindElder&&N.bindElder(...e)),["prevent"]))},[(0,l.Lk)("div",d,[t[4]||(t[4]=(0,l.Lk)("label",{for:"elderName"},"老人姓名",-1)),(0,l.bo)((0,l.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>U.bindingForm.name=e),type:"text",id:"elderName",placeholder:"请输入老人姓名",required:""},null,512),[[r.Jo,U.bindingForm.name]])]),(0,l.Lk)("div",h,[t[5]||(t[5]=(0,l.Lk)("label",{for:"elderIdCard"},"老人身份证",-1)),(0,l.bo)((0,l.Lk)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>U.bindingForm.idCard=e),type:"text",id:"elderIdCard",placeholder:"请输入老人身份证号",required:""},null,512),[[r.Jo,U.bindingForm.idCard]])]),(0,l.Lk)("div",c,[t[6]||(t[6]=(0,l.Lk)("label",{for:"relation"},"与老人的关系",-1)),(0,l.bo)((0,l.Lk)("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>U.bindingForm.relation=e),type:"text",id:"relation",placeholder:"例如：儿子、女儿",required:""},null,512),[[r.Jo,U.bindingForm.relation]])]),t[7]||(t[7]=(0,l.Lk)("button",{type:"submit",class:"submit-btn"},"立即绑定",-1))],32)])])),U.elderInfo?((0,l.uX)(),(0,l.CE)("div",u,[t[19]||(t[19]=(0,l.Lk)("div",{class:"header"},[(0,l.Lk)("h2",null,"老人健康管理")],-1)),(0,l.Lk)("div",m,[(0,l.Lk)("div",g,[(0,l.Lk)("h3",null,(0,o.v_)(U.elderInfo.name),1)]),(0,l.Lk)("div",k,[(0,l.Lk)("div",L,[t[10]||(t[10]=(0,l.Lk)("span",null,"年龄",-1)),(0,l.Lk)("strong",null,(0,o.v_)(U.elderInfo.age)+" 岁",1)]),(0,l.Lk)("div",v,[t[11]||(t[11]=(0,l.Lk)("span",null,"性别",-1)),(0,l.Lk)("strong",null,(0,o.v_)(U.elderInfo.gender),1)]),(0,l.Lk)("div",b,[t[12]||(t[12]=(0,l.Lk)("span",null,"绑定日期",-1)),(0,l.Lk)("strong",null,(0,o.v_)(U.elderInfo.bindDate),1)])])]),(0,l.Lk)("div",f,[(0,l.Lk)("div",y,[t[13]||(t[13]=(0,l.Lk)("h4",null,"心率 (次/分钟)",-1)),(0,l.Lk)("p",p,(0,o.v_)(N.latestHeartRate),1),(0,l.Lk)("div",D,"历史: "+(0,o.v_)(U.healthData.heartRate.join(", ")),1)]),(0,l.Lk)("div",_,[t[14]||(t[14]=(0,l.Lk)("h4",null,"血压 (mmHg)",-1)),(0,l.Lk)("p",I,(0,o.v_)(N.latestBloodPressure),1),(0,l.Lk)("div",w,"收缩压: "+(0,o.v_)(U.healthData.bloodPressure.systolic.join(", ")),1),(0,l.Lk)("div",A,"舒张压: "+(0,o.v_)(U.healthData.bloodPressure.diastolic.join(", ")),1)]),(0,l.Lk)("div",S,[t[15]||(t[15]=(0,l.Lk)("h4",null,"血糖 (mmol/L)",-1)),(0,l.Lk)("p",E,(0,o.v_)(N.latestBloodSugar),1),(0,l.Lk)("div",H,"历史: "+(0,o.v_)(U.healthData.bloodSugar.join(", ")),1)]),(0,l.Lk)("div",$,[t[16]||(t[16]=(0,l.Lk)("h4",null,"体重 (kg)",-1)),(0,l.Lk)("p",B,(0,o.v_)(N.latestWeight),1),(0,l.Lk)("div",C,"历史: "+(0,o.v_)(U.healthData.weight.join(", ")),1)])]),(0,l.Lk)("div",P,[(0,l.Lk)("div",R,[t[17]||(t[17]=(0,l.Lk)("h4",null,"过敏史",-1)),(0,l.Lk)("p",null,(0,o.v_)(U.healthData.allergyHistory||"暂无数据"),1)]),(0,l.Lk)("div",j,[t[18]||(t[18]=(0,l.Lk)("h4",null,"既往病史",-1)),(0,l.Lk)("p",null,(0,o.v_)(U.healthData.medicalHistory||"暂无数据"),1)])])])):(0,l.Q3)("",!0)])}var U=a(9871),N={name:"FHealthy",data(){return{baseUrl:U.A.API_BASE_URL,bindingForm:{name:"",idCard:"",relation:""},elderInfo:null,healthData:{heartRate:[],bloodPressure:{systolic:[],diastolic:[]},bloodSugar:[],weight:[],allergyHistory:"",medicalHistory:""}}},computed:{latestHeartRate(){return this.healthData.heartRate.length>0?this.healthData.heartRate[this.healthData.heartRate.length-1]:"N/A"},latestBloodPressure(){const e=this.healthData.bloodPressure;return e.systolic.length>0?`${e.systolic[e.systolic.length-1]} / ${e.diastolic[e.diastolic.length-1]}`:"N/A"},latestBloodSugar(){return this.healthData.bloodSugar.length>0?this.healthData.bloodSugar[this.healthData.bloodSugar.length-1]:"N/A"},latestWeight(){return this.healthData.weight.length>0?this.healthData.weight[this.healthData.weight.length-1]:"N/A"}},methods:{async fetchBoundElder(){const e=localStorage.getItem("token");if(e)try{const t=await fetch(`${this.baseUrl}/family/bind`,{method:"GET",headers:{Authorization:`Bearer ${e}`}}),a=await t.json();1===a.code&&a.data?(this.elderInfo=a.data,this.fetchAllHealthData()):this.elderInfo=null}catch(t){console.error("Error fetching bound elder:",t),this.elderInfo=null}else console.error("Authentication token not found.")},async bindElder(){const e=localStorage.getItem("token");if(e)try{const t=await fetch(`${this.baseUrl}/family/bind`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify(this.bindingForm)}),a=await t.json();1===a.code?(alert("绑定成功！"),this.fetchBoundElder()):alert(`绑定失败: ${a.message}`)}catch(t){console.error("Error binding elder:",t),alert("绑定过程中发生错误。")}else alert("请先登录！")},async fetchAllHealthData(){const e=localStorage.getItem("token");if(!this.elderInfo||!e)return;const t={Authorization:`Bearer ${e}`},a={heartRate:"heartRate",bloodPressure:"bloodPressure",bloodSugar:"bloodSugar",weight:"weight",allergyHistory:"allergyHistory",medicalHistory:"medicalHistory"};for(const r in a){const e=a[r];try{const a=await fetch(`${this.baseUrl}/health/${e}/history`,{headers:t}),l=await a.json();1===l.code?this.healthData[r]=l.data:console.warn(`Could not fetch ${r}: ${l.message}`)}catch(l){console.error(`Error fetching ${r}:`,l)}}}},mounted(){this.fetchBoundElder()}},J=a(1241);const q=(0,J.A)(N,[["render",F],["__scopeId","data-v-859e04c2"]]);var x=q},9871:function(e,t){const a={API_BASE_URL:"https://14.103.237.241"};t.A=a}}]);
//# sourceMappingURL=269.08fdf928.js.map