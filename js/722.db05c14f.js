"use strict";(self["webpackChunkvue_demo2"]=self["webpackChunkvue_demo2"]||[]).push([[722],{6722:function(l,a,s){s.r(a),s.d(a,{default:function(){return N}});var e=s(6768),t=s(4232),u=s(144),r=s(9871);const c={class:"health-dashboard-container"},i={class:"dashboard-header"},n={key:0,class:"last-updated"},v={key:0,class:"status-overlay"},o={key:1,class:"status-overlay error"},d={key:2,class:"dashboard-grid"},k={class:"metric-card heart-rate"},L={class:"latest-value"},h={class:"metric-card blood-pressure"},p={class:"latest-value"},y={class:"metric-card blood-sugar"},C={class:"latest-value"},b={class:"metric-card weight"},E={class:"latest-value"},w={class:"history-card wide-card"},g={class:"history-card wide-card"},_={class:"history-card"},m={key:0,class:"bar-chart-list"},X={class:"label"},A={class:"bar-wrapper"},f={key:1},K={class:"history-card"},R={key:0,class:"bar-chart-list dual-bar"},H={class:"label"},V={class:"bar-wrapper"},M={key:1},I={class:"history-card"},T={key:0,class:"bar-chart-list"},W={class:"label"},$={class:"bar-wrapper"},B={key:1},x={class:"history-card"},S={key:0,class:"bar-chart-list"},F={class:"label"},P={class:"bar-wrapper"},Q={key:1},Z="token";var j={__name:"ElderHealthyManage",setup(l){const a=r.A.API_BASE_URL,s=(0,u.KR)([]),j=(0,u.KR)([]),z=(0,u.KR)([]),D=(0,u.KR)([]),N=(0,u.KR)(""),U=(0,u.KR)(""),q=(0,u.KR)(""),G=(0,u.KR)(!0),J=(0,u.KR)(null),O=(0,e.EW)((()=>s.value[0]??null)),Y=(0,e.EW)((()=>{if(!j.value.length)return null;const l=j.value[0];return`${l.systolic}/${l.diastolic}`})),ll=(0,e.EW)((()=>z.value[0]??null)),al=(0,e.EW)((()=>D.value[0]??null)),sl=async()=>{G.value=!0,J.value=null;const l=localStorage.getItem(Z);if(!l)return J.value="用户未登录，请先登录。",void(G.value=!1);const e={Authorization:`Bearer ${l}`,"Content-Type":"application/json"},t=["heartRate","bloodPressure","bloodSugar","weight","medicalHistory","allergyHistory"];try{const l=t.map((l=>{const s=`${a}/health/${l}/history`;return fetch(s,{headers:e}).then((async a=>{if(401===a.status||403===a.status)throw new Error("身份验证失败，请重新登录。");if(!a.ok)throw new Error(`请求 ${l} 失败: ${a.status} ${a.statusText}`);const s=a.headers.get("content-type");return s?.includes("application/json")?a.json():a.text()}))})),u=await Promise.all(l),[r,c,i,n,v,o]=u;s.value=r.slice(-7).reverse(),j.value=c.slice(-7).reverse(),z.value=i.slice(-7).reverse(),D.value=n.slice(-7).reverse(),N.value=v,U.value=o,q.value=(new Date).toLocaleString("zh-CN")}catch(u){console.error("获取健康数据失败:",u),J.value=u.message||"无法连接到服务器。"}finally{G.value=!1}},el=(l,a,s)=>l<a?0:l>s?100:(l-a)/(s-a)*100;return(0,e.sV)((()=>{a.includes("127.0.0.1")?(console.warn("正在使用模拟数据进行演示。请确保您的后端服务已启动并正确配置。"),setTimeout((()=>{s.value=[72,75,71,78,76,80,74].reverse(),j.value=[{systolic:120,diastolic:80},{systolic:122,diastolic:81},{systolic:125,diastolic:80},{systolic:118,diastolic:78},{systolic:130,diastolic:85},{systolic:124,diastolic:82},{systolic:126,diastolic:83}].reverse(),z.value=[5.5,6.1,5.8,6.5,7,6.2,5.9].reverse(),D.value=[70.5,70.2,71,70.8,70.5,70.9,70.6].reverse(),N.value="高血压 (2010年确诊), 2型糖尿病 (2015年确诊)。",U.value="青霉素 (会引起皮疹)。",q.value=(new Date).toLocaleString("zh-CN"),G.value=!1,J.value=null}),1500)):sl()})),(l,a)=>((0,e.uX)(),(0,e.CE)("div",c,[(0,e.Lk)("header",i,[a[0]||(a[0]=(0,e.Lk)("div",null,[(0,e.Lk)("h1",null,"健康看板"),(0,e.Lk)("p",{class:"subtitle"},"关键健康指标综合概览。")],-1)),G.value||J.value?(0,e.Q3)("",!0):((0,e.uX)(),(0,e.CE)("div",n," 最后更新于： "+(0,t.v_)(q.value),1))]),G.value?((0,e.uX)(),(0,e.CE)("div",v,a[1]||(a[1]=[(0,e.Lk)("div",{class:"spinner"},null,-1),(0,e.Lk)("p",null,"正在加载健康数据...",-1)]))):(0,e.Q3)("",!0),J.value?((0,e.uX)(),(0,e.CE)("div",o,[a[2]||(a[2]=(0,e.Lk)("div",{class:"error-icon"},"!",-1)),(0,e.Lk)("p",null,"数据加载失败："+(0,t.v_)(J.value),1),(0,e.Lk)("button",{onClick:sl},"重试")])):(0,e.Q3)("",!0),G.value||J.value?(0,e.Q3)("",!0):((0,e.uX)(),(0,e.CE)("main",d,[(0,e.Lk)("div",k,[a[4]||(a[4]=(0,e.Lk)("div",{class:"card-header"},[(0,e.Lk)("svg",{class:"icon",viewBox:"0 0 24 24"},[(0,e.Lk)("path",{d:"M12,21.35L10.55,20.03C5.4,15.36 2,12.27 2,8.5C2,5.41 4.42,3 7.5,3C9.24,3 10.91,3.81 12,5.08C13.09,3.81 14.76,3 16.5,3C19.58,3 22,5.41 22,8.5C22,12.27 18.6,15.36 13.45,20.03L12,21.35Z"})]),(0,e.Lk)("h2",null,"心率")],-1)),(0,e.Lk)("p",L,[(0,e.eW)((0,t.v_)(O.value||"无数据")+" ",1),a[3]||(a[3]=(0,e.Lk)("span",null,"bpm",-1))])]),(0,e.Lk)("div",h,[a[6]||(a[6]=(0,e.Lk)("div",{class:"card-header"},[(0,e.Lk)("svg",{class:"icon",viewBox:"0 0 24 24"},[(0,e.Lk)("path",{d:"M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,4A8,8 0 0,1 20,12H17A5,5 0 0,0 12,7V4M4,12A8,8 0 0,1 12,4V7A5,5 0 0,0 7,12H4Z"})]),(0,e.Lk)("h2",null,"血压")],-1)),(0,e.Lk)("p",p,[(0,e.eW)((0,t.v_)(Y.value||"无数据")+" ",1),a[5]||(a[5]=(0,e.Lk)("span",null,"mmHg",-1))])]),(0,e.Lk)("div",y,[a[8]||(a[8]=(0,e.Lk)("div",{class:"card-header"},[(0,e.Lk)("svg",{class:"icon",viewBox:"0 0 24 24"},[(0,e.Lk)("path",{d:"M18.5,1.15C18.25,1.15 18,1.25 17.82,1.42L12.5,6.74L7.18,1.42C7,1.25 6.75,1.15 6.5,1.15C6.09,1.15 5.75,1.46 5.75,1.85V10.78C5.75,11.71 6.47,12.46 7.39,12.5C8.3,12.54 9.08,11.86 9.08,11V4.28L12.5,7.69L15.92,4.28V11C15.92,11.86 16.7,12.54 17.61,12.5C18.53,12.46 19.25,11.71 19.25,10.78V1.85C19.25,1.46 18.91,1.15 18.5,1.15M20,15H5C4.45,15 4,15.45 4,16V21C4,21.55 4.45,22 5,22H20C20.55,22 21,21.55 21,21V16C21,15.45 20.55,15 20,15Z"})]),(0,e.Lk)("h2",null,"血糖")],-1)),(0,e.Lk)("p",C,[(0,e.eW)((0,t.v_)(ll.value||"无数据")+" ",1),a[7]||(a[7]=(0,e.Lk)("span",null,"mmol/L",-1))])]),(0,e.Lk)("div",b,[a[10]||(a[10]=(0,e.Lk)("div",{class:"card-header"},[(0,e.Lk)("svg",{class:"icon",viewBox:"0 0 24 24"},[(0,e.Lk)("path",{d:"M12,3A9,9 0 0,0 3,12A9,9 0 0,0 12,21A9,9 0 0,0 21,12A9,9 0 0,0 12,3M12,11H6V13H12V11M10,5L12,9L14,5H10Z"})]),(0,e.Lk)("h2",null,"体重")],-1)),(0,e.Lk)("p",E,[(0,e.eW)((0,t.v_)(al.value||"无数据")+" ",1),a[9]||(a[9]=(0,e.Lk)("span",null,"kg",-1))])]),(0,e.Lk)("div",w,[a[11]||(a[11]=(0,e.Lk)("h2",null,"病史记录",-1)),(0,e.Lk)("p",null,(0,t.v_)(N.value||"暂无病史记录。"),1)]),(0,e.Lk)("div",g,[a[12]||(a[12]=(0,e.Lk)("h2",null,"过敏史",-1)),(0,e.Lk)("p",null,(0,t.v_)(U.value||"暂无过敏史记录。"),1)]),(0,e.Lk)("div",_,[a[13]||(a[13]=(0,e.Lk)("h2",null,"心率历史记录 (bpm)",-1)),s.value.length?((0,e.uX)(),(0,e.CE)("ul",m,[((0,e.uX)(!0),(0,e.CE)(e.FK,null,(0,e.pI)(s.value,((l,a)=>((0,e.uX)(),(0,e.CE)("li",{key:a},[(0,e.Lk)("span",X,(0,t.v_)(l),1),(0,e.Lk)("div",A,[(0,e.Lk)("span",{class:"bar",style:(0,t.Tr)({width:el(l,40,160)+"%"})},null,4)])])))),128))])):((0,e.uX)(),(0,e.CE)("p",f,"暂无历史记录。"))]),(0,e.Lk)("div",K,[a[14]||(a[14]=(0,e.Lk)("h2",null,"血压历史记录 (收缩压/舒张压)",-1)),j.value.length?((0,e.uX)(),(0,e.CE)("ul",R,[((0,e.uX)(!0),(0,e.CE)(e.FK,null,(0,e.pI)(j.value,((l,a)=>((0,e.uX)(),(0,e.CE)("li",{key:a},[(0,e.Lk)("span",H,(0,t.v_)(l.systolic)+" / "+(0,t.v_)(l.diastolic),1),(0,e.Lk)("div",V,[(0,e.Lk)("span",{class:"bar systolic",style:(0,t.Tr)({width:el(l.systolic,60,200)+"%"})},null,4),(0,e.Lk)("span",{class:"bar diastolic",style:(0,t.Tr)({width:el(l.diastolic,40,120)+"%"})},null,4)])])))),128))])):((0,e.uX)(),(0,e.CE)("p",M,"暂无历史记录。"))]),(0,e.Lk)("div",I,[a[15]||(a[15]=(0,e.Lk)("h2",null,"血糖历史记录 (mmol/L)",-1)),z.value.length?((0,e.uX)(),(0,e.CE)("ul",T,[((0,e.uX)(!0),(0,e.CE)(e.FK,null,(0,e.pI)(z.value,((l,a)=>((0,e.uX)(),(0,e.CE)("li",{key:a},[(0,e.Lk)("span",W,(0,t.v_)(l),1),(0,e.Lk)("div",$,[(0,e.Lk)("span",{class:"bar",style:(0,t.Tr)({width:el(l,2,15)+"%"})},null,4)])])))),128))])):((0,e.uX)(),(0,e.CE)("p",B,"暂无历史记录。"))]),(0,e.Lk)("div",x,[a[16]||(a[16]=(0,e.Lk)("h2",null,"体重历史记录 (kg)",-1)),D.value.length?((0,e.uX)(),(0,e.CE)("ul",S,[((0,e.uX)(!0),(0,e.CE)(e.FK,null,(0,e.pI)(D.value,((l,a)=>((0,e.uX)(),(0,e.CE)("li",{key:a},[(0,e.Lk)("span",F,(0,t.v_)(l),1),(0,e.Lk)("div",P,[(0,e.Lk)("span",{class:"bar",style:(0,t.Tr)({width:el(l,40,120)+"%"})},null,4)])])))),128))])):((0,e.uX)(),(0,e.CE)("p",Q,"暂无历史记录。"))])]))]))}},z=s(1241);const D=(0,z.A)(j,[["__scopeId","data-v-35fdd99e"]]);var N=D},9871:function(l,a){const s={API_BASE_URL:"https://wanghua935.dpdns.org:8080"};a.A=s}}]);
//# sourceMappingURL=722.db05c14f.js.map